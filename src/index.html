<!DOCTYPE html>
<html lang="en">
<head>
    <title>VR Escape - Virtual Reality Escape Rooms</title>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description"
          content="Experience the ultimate VR escape room adventure. Book your immersive virtual reality experience today!"/>
    <base href="/">
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <script>
        (function () {
            const PARENT_ORIGIN = 'https://intetic.com';
            let lastHeight = 0;
            let ro = null;
            let rafId = null;

            function getHeight() {
                const b = document.body, d = document.documentElement;
                return Math.max(
                    b.scrollHeight, d.scrollHeight,
                    b.offsetHeight, d.offsetHeight,
                    b.clientHeight, d.clientHeight
                );
            }

            function post(msg) {
                window.parent.postMessage(msg, PARENT_ORIGIN);
            }

            // Throttled height sender
            function schedulePostHeight(shrinkAware = true) {
                if (rafId) cancelAnimationFrame(rafId);
                rafId = requestAnimationFrame(function () {
                    const h = getHeight();
                    const shrank = shrinkAware && lastHeight && h < lastHeight - 80; // 80px threshold
                    lastHeight = h;
                    post({type: 'booking-system:heightAndMaybeScroll', height: h, shrank});
                });
            }

            function safeObserve(el) {
                if (!el || el.nodeType !== 1) return; // ensure it's an Element
                try {
                    ro.observe(el);
                } catch (err) { /* ignore */
                }
            }

            window.addEventListener('load', function () {
                // Initial post
                schedulePostHeight(false);

                // Observe size/layout changes
                ro = new ResizeObserver(() => schedulePostHeight(true));

                // Prefer a dedicated content root if you have one (e.g., '#app', '#root')
                const contentRoot =
                    document.getElementById('app') ||
                    document.getElementById('root') ||
                    document.body;

                safeObserve(contentRoot);
                // As a fallback, also observe the documentElement
                safeObserve(document.documentElement);

                // Periodic fallback for async layout shifts (fonts/images/routes)
                setInterval(() => schedulePostHeight(true), 800);
            });

            // Optional: call from your code after major UI transitions
            window.requestParentScrollToTop = function () {
                post({type: 'booking-system:scrollToTop'});
            };
        })();
    </script>

</head>
<body>
<app-root>Loading...</app-root>
</body>
</html>
