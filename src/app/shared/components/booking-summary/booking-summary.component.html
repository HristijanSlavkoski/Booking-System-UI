<div class="booking-summary">
    <h3>Booking Summary</h3>

    <div class="summary-item">
        <span class="label">Date:</span>
        <span class="value">{{ date }}</span>
    </div>
    <div class="summary-item">
        <span class="label">Time:</span>
        <span class="value">{{ time }}</span>
    </div>
    <div class="summary-item">
        <span class="label">Rooms:</span>
        <span class="value">{{ rooms }}</span>
    </div>

    <ng-container *ngFor="let r of roomSummaries; let i = index">
        <div class="summary-item">
            <span class="label">Room {{ i + 1 }}:</span>
            <span class="value">
        {{ r.name || 'No game' }} — {{ r.playerCount }}
                {{ r.playerCount === 1 ? 'player' : 'players' }}
      </span>
        </div>
    </ng-container>

    <div class="summary-item">
        <span class="label">Total Players:</span>
        <span class="value">{{ totalPlayers }}</span>
    </div>

    <!-- PROMO BANNER (after promo, before gift card) -->
    <div
            *ngIf="promoPercent && promoPercent > 0 && baseTotal !== null"
            class="promo-banner"
    >
        <div class="promo-badge">-{{ promoPercent }}%</div>
        <div class="promo-text">
            {{ promoName || 'Special promotion' }}
        </div>

        <!-- small X icon (only if removable) -->
        <button
                *ngIf="onRemovePromo"
                class="remove-promo-btn"
                type="button"
                (click)="onRemovePromo.emit()"
                title="Remove promotion"
        >
            ✕
        </button>

        <div class="promo-prices">
            <!-- Old: base (no promo) -->
            <span class="old-price">
              {{ baseTotal | number:'1.0-0' }} {{ currency }}
            </span>

            <!-- New: after promo, before gift; fall back to total if promoTotal missing -->
            <span class="new-price">
              {{ (promoTotal ?? total) | number:'1.0-0' }} {{ currency }}
            </span>
        </div>
    </div>

    <!-- Gift card line (only if applied) -->
    <div class="summary-item" *ngIf="giftCardAmount && giftCardAmount > 0">
    <span class="label">
      Gift card
      <ng-container *ngIf="giftCardCode">
        ({{ giftCardCode }})
      </ng-container>:
    </span>
        <span class="value">-{{ giftCardAmount | number:'1.0-0' }} {{ currency }}</span>
    </div>

    <!-- Text-only totals (final total with promo + gift card) -->
    <app-price-summary
            [net]="net"
            [vat]="vat"
            [total]="total"
            [taxPercent]="taxPercent"
            [currency]="currency"
    ></app-price-summary>
</div>
